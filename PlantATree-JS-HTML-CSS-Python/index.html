<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlantATree - –ï–∫–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∏ –°–æ—Ñ–∏—è</title>
    <link rel="stylesheet" href="design.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Geoapify Maps CSS and JS -->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/@geoapify/leaflet-address-search-plugin@^1/dist/L.Control.GeoapifyAddressSearch.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <!-- Leaflet Draw for drawing shapes on map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
    <script src="https://unpkg.com/@geoapify/leaflet-address-search-plugin@^1/dist/L.Control.GeoapifyAddressSearch.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-tree"></i>
                <span>PlantATree</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#" onclick="showSection('home')" class="nav-link">–ù–∞—á–∞–ª–æ</a></li>
                <li><a href="#" onclick="showSection('map')" class="nav-link">–ö–∞—Ä—Ç–∞</a></li>
                <li><a href="#" onclick="showSection('feed')" class="nav-link">–ï–∫–æ –¥–µ–π—Å—Ç–≤–∏—è</a></li>
                <li><a href="#" onclick="showSection('air-quality')" class="nav-link">–í—ä–∑–¥—É—Ö</a></li>
                <li><a href="#" onclick="showSection('leaderboard')" class="nav-link">–ö–ª–∞—Å–∞—Ü–∏—è</a></li>
                <li><a href="#" onclick="showSection('profile')" class="nav-link">–ü—Ä–æ—Ñ–∏–ª</a></li>
            </ul>
            <div class="auth-buttons">
                <button class="btn-login">–í—Ö–æ–¥</button>
                <button class="btn-register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>–ü–æ–º–æ–≥–Ω–∏ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º –°–æ—Ñ–∏—è –ø–æ-–∑–µ–ª–µ–Ω–∞</h1>
            <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ –∫–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∑–µ–ª–µ–Ω–∏ –∑–æ–Ω–∏, –µ–∫–æ –ø—ä—Ç–µ–∫–∏ –∏ —Å–ø–æ–¥–µ–ª—è–Ω–µ –Ω–∞ –µ–∫–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∏ –≤ –ë—ä–ª–≥–∞—Ä–∏—è</p>
            <div class="hero-buttons">
                <button class="btn-primary" onclick="showSection('map')">
                    <i class="fas fa-map-marked-alt"></i> –†–∞–∑–≥–ª–µ–¥–∞–π –∫–∞—Ä—Ç–∞—Ç–∞
                </button>
                <button class="btn-secondary" onclick="showSection('feed')">
                    <i class="fas fa-leaf"></i> –ï–∫–æ –¥–µ–π—Å—Ç–≤–∏—è
                </button>
            </div>
        </div>
        <div class="hero-stats">
            <div class="stat">
                <div class="stat-number">150+</div>
                <div class="stat-label">–ó–µ–ª–µ–Ω–∏ –∑–æ–Ω–∏</div>
            </div>
            <div class="stat">
                <div class="stat-number">500+</div>
                <div class="stat-label">–ó–∞—Å–∞–¥–µ–Ω–∏ –¥—ä—Ä–≤–µ—Ç–∞</div>
            </div>
            <div class="stat">
                <div class="stat-number">200+</div>
                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</div>
            </div>
        </div>
    </section>

    <!-- Map Section -->
    <section id="map" class="section hidden">
        <div class="section-header">
            <h2><i class="fas fa-map-marked-alt"></i> –ö–∞—Ä—Ç–∞ –Ω–∞ –∑–µ–ª–µ–Ω–∏—Ç–µ –∑–æ–Ω–∏</h2>
            <p>–û—Ç–∫—Ä–∏–π –ø–∞—Ä–∫–æ–≤–µ, –µ–∫–æ –ø—ä—Ç–µ–∫–∏ –∏ –≤–µ–ª–æ–∞–ª–µ–∏ –≤ –°–æ—Ñ–∏—è</p>
        </div>
        
        <!-- Sofia Redesign Tools Panel -->
        <div class="sofia-tools-panel">
            <h3><i class="fas fa-hammer"></i> –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –ø—Ä–µ—É—Å—Ç—Ä–æ–π–≤–∞–Ω–µ –Ω–∞ –°–æ—Ñ–∏—è</h3>
            <div class="temporary-notice">
                <i class="fas fa-info-circle"></i>
                <span>–í—Å–∏—á–∫–∏ –ø—Ä–æ–º–µ–Ω–∏ —Å–∞ –≤—Ä–µ–º–µ–Ω–Ω–∏ –∏ —â–µ —Å–µ –∑–∞–≥—É–±—è—Ç –ø—Ä–∏ –ø—Ä–µ–∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞</span>
            </div>
            <div class="redesign-tools">
                <button class="redesign-tool active" id="select-tool" onclick="setRedesignTool('select')">
                    <i class="fas fa-mouse-pointer"></i>
                    –°–µ–ª–µ–∫—Ç–∏—Ä–∞–Ω–µ
                </button>
                <button class="redesign-tool" id="park-tool" onclick="setRedesignTool('park')">
                    <i class="fas fa-tree"></i>
                    –ü–∞—Ä–∫
                </button>
                <button class="redesign-tool" id="alley-tool" onclick="setRedesignTool('alley')">
                    <i class="fas fa-road"></i>
                    –ê–ª–µ—è/–£–ª–∏—Ü–∞
                </button>
                <button class="redesign-tool" id="green-zone-tool" onclick="setRedesignTool('greenzone')">
                    <i class="fas fa-leaf"></i>
                    –ó–µ–ª–µ–Ω–∞ –∑–æ–Ω–∞
                </button>
                <button class="redesign-tool" id="bike-lane-tool" onclick="setRedesignTool('bikelane')">
                    <i class="fas fa-bicycle"></i>
                    –í–µ–ª–æ–∞–ª–µ—è
                </button>
                <button class="redesign-tool" id="clear-tool" onclick="clearAllRedesigns()">
                    <i class="fas fa-eraser"></i>
                    –ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–æ
                </button>
            </div>
            <div class="current-tool-info">
                <span id="current-redesign-tool">–ò–∑–±—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: –°–µ–ª–µ–∫—Ç–∏—Ä–∞–Ω–µ –æ–±–ª–∞—Å—Ç</span>
                <small>–ö–ª–∏–∫–Ω–µ—Ç–µ –∏ –≤–ª–∞—á–µ—Ç–µ –≤—ä—Ä—Ö—É –∫–∞—Ä—Ç–∞—Ç–∞ –∑–∞ –¥–∞ —Å–µ–ª–µ–∫—Ç–∏—Ä–∞—Ç–µ –æ–±–ª–∞—Å—Ç –∑–∞ –ø—Ä–µ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. –ü—Ä–æ–º–µ–Ω–∏—Ç–µ —Å–∞ –≤—Ä–µ–º–µ–Ω–Ω–∏.</small>
            </div>
        </div>
        
        <div class="map-container">
            <div id="map-canvas" class="map-canvas">
                <div class="map-placeholder" id="map-placeholder">
                    <i class="fas fa-map"></i>
                    <p>–ö–ª–∏–∫–Ω–µ—Ç–µ "–ü–æ–∫–∞–∂–∏ –∫–∞—Ä—Ç–∞" –∑–∞ –¥–∞ –∑–∞—Ä–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—Ç–∞ –∫–∞—Ä—Ç–∞</p>
                    <button onclick="loadMapWithRedesign()" style="background: #7bc142; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                        üó∫Ô∏è –ü–æ–∫–∞–∂–∏ –∫–∞—Ä—Ç–∞ –Ω–∞ –°–æ—Ñ–∏—è
                    </button>
                </div>
            </div>
            <div class="map-sidebar">
                <!-- Sofia Stats Panel -->
                <div class="sofia-sidebar-stats">
                    <h3><i class="fas fa-city"></i> –°–æ—Ñ–∏—è</h3>
                    <div class="sidebar-stats-grid">
                        <div class="sidebar-stat-item">
                            <i class="fas fa-tree stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ó–µ–ª–µ–Ω–∏–Ω–∞</span>
                                <span class="stat-value" id="sidebar-green-percent">30%</span>
                            </div>
                        </div>
                        <div class="sidebar-stat-item">
                            <i class="fas fa-leaf stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ü–∞—Ä–∫–æ–≤–µ</span>
                                <span class="stat-value" id="sidebar-parks-count">126</span>
                            </div>
                        </div>
                        <div class="sidebar-stat-item">
                            <i class="fas fa-users stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ù–∞—Å–µ–ª–µ–Ω–∏–µ</span>
                                <span class="stat-value" id="sidebar-population">1.4–ú</span>
                            </div>
                        </div>
                        <div class="sidebar-stat-item">
                            <i class="fas fa-expand-arrows-alt stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ü–ª–æ—â</span>
                                <span class="stat-value" id="sidebar-area">492 –∫–º¬≤</span>
                            </div>
                        </div>
                        <div class="sidebar-stat-item">
                            <i class="fas fa-seedling stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ó–µ–ª–µ–Ω–∏ –∑–æ–Ω–∏</span>
                                <span class="stat-value" id="sidebar-green-area">147.6 –∫–º¬≤</span>
                            </div>
                        </div>
                        <div class="sidebar-stat-item air-quality-item">
                            <i class="fas fa-wind stat-icon"></i>
                            <div class="stat-info">
                                <span class="stat-label">–ö–∞—á–µ—Å—Ç–≤–æ –≤—ä–∑–¥—É—Ö</span>
                                <span class="stat-value" id="sidebar-air-quality">72</span>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>–§–∏–ª—Ç—Ä–∏</h3>
                <div class="filter-group">
                    <label><input type="checkbox" checked onchange="filterLocationsByType()"> –ü–∞—Ä–∫–æ–≤–µ</label>
                    <label><input type="checkbox" checked onchange="filterLocationsByType()"> –ï–∫–æ –ø—ä—Ç–µ–∫–∏</label>
                    <label><input type="checkbox" checked onchange="filterLocationsByType()"> –í–µ–ª–æ–∞–ª–µ–∏</label>
                    <label><input type="checkbox" checked onchange="filterLocationsByType()"> –ú–µ—Å—Ç–∞ –∑–∞ –∑–∞—Å–∞–∂–¥–∞–Ω–µ</label>
                </div>
                <button class="btn-primary" onclick="showAddLocationModal()">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏ –ª–æ–∫–∞—Ü–∏—è
                </button>
            </div>
        </div>
        
        <!-- Sofia Facts Panel -->
        <div class="sofia-facts-panel" id="sofia-facts-panel" style="display: none;">
            <h3><i class="fas fa-lightbulb"></i> –ó–Ω–∞–µ—Ç–µ –ª–∏, —á–µ...</h3>
            <div class="fact-container">
                <div class="fact-item" id="current-fact">
                    <p>–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∏ —Ñ–∞–∫—Ç–∏ –∑–∞ –°–æ—Ñ–∏—è...</p>
                </div>
                <button class="fact-btn" onclick="showRandomFact()">
                    <i class="fas fa-refresh"></i> –ù–æ–≤ —Ñ–∞–∫—Ç
                </button>
            </div>
        </div>
    </section>


        
        <div class="builder-container" style="display: none;">
            <!-- City Stats Panel -->
            <div class="city-stats-panel">
                <h3><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –≥—Ä–∞–¥–∞</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="population">5000</span>
                            <span class="stat-label">–ù–∞—Å–µ–ª–µ–Ω–∏–µ</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-leaf"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="green-coverage">35%</span>
                            <span class="stat-label">–ó–µ–ª–µ–Ω–æ –ø–æ–∫—Ä–∏—Ç–∏–µ</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-info">
                            <span class="stat-value" id="budget">25000</span>
                            <span class="stat-label">–ë—é–¥–∂–µ—Ç</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üòä</div>
                        <div class="stat-info">
                            <span class="stat-value" id="happiness">80</span>
                            <span class="stat-label">–©–∞—Å—Ç–∏–µ %</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Building Tools Panel -->
            <div class="building-tools-panel">
                <h3><i class="fas fa-tools"></i> –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ —Å—Ç—Ä–æ–µ–Ω–µ</h3>
                <div class="tool-categories">
                    <div class="tool-category">
                        <h4><i class="fas fa-tree"></i> –ó–µ–ª–µ–Ω–∏ –∑–æ–Ω–∏</h4>
                        <div class="tools-grid">
                            <button class="tool-btn" onclick="selectTool('park')" data-tool="park">
                                <i class="fas fa-tree"></i>
                                <span>–ü–∞—Ä–∫</span>
                                <small>–¶–µ–Ω–∞: 500</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('forest')" data-tool="forest">
                                <i class="fas fa-seedling"></i>
                                <span>–ì–æ—Ä–∞</span>
                                <small>–¶–µ–Ω–∞: 800</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('garden')" data-tool="garden">
                                <i class="fas fa-leaf"></i>
                                <span>–ì—Ä–∞–¥–∏–Ω–∞</span>
                                <small>–¶–µ–Ω–∞: 300</small>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-category">
                        <h4>üè¢ –°–≥—Ä–∞–¥–∏</h4>
                        <div class="tools-grid">
                            <button class="tool-btn" onclick="selectTool('residential')" data-tool="residential">
                                <i class="fas fa-home"></i>
                                <span>–ñ–∏–ª–∏—â–Ω–∞</span>
                                <small>–¶–µ–Ω–∞: 1200</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('commercial')" data-tool="commercial">
                                <i class="fas fa-store"></i>
                                <span>–¢—ä—Ä–≥–æ–≤—Å–∫–∞</span>
                                <small>–¶–µ–Ω–∞: 1500</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('industrial')" data-tool="industrial">
                                <i class="fas fa-industry"></i>
                                <span>–ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª–Ω–∞</span>
                                <small>–¶–µ–Ω–∞: 2000</small>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-category">
                        <h4>üöó –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h4>
                        <div class="tools-grid">
                            <button class="tool-btn" onclick="selectTool('road')" data-tool="road">
                                <i class="fas fa-road"></i>
                                <span>–ü—ä—Ç</span>
                                <small>–¶–µ–Ω–∞: 100</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('bike-path')" data-tool="bike-path">
                                <i class="fas fa-bicycle"></i>
                                <span>–í–µ–ª–æ–∞–ª–µ—è</span>
                                <small>–¶–µ–Ω–∞: 200</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('solar')" data-tool="solar">
                                <i class="fas fa-solar-panel"></i>
                                <span>–°–æ–ª–∞—Ä–Ω–∏ –ø–∞–Ω–µ–ª–∏</span>
                                <small>–¶–µ–Ω–∞: 1000</small>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tool-category">
                        <h4><i class="fas fa-tools"></i> Utilities</h4>
                        <div class="tools-grid">
                            <button class="tool-btn" onclick="selectTool('demolish')" data-tool="demolish">
                                <i class="fas fa-trash"></i>
                                <span>–°—ä–±–æ—Ä—è–≤–∞–Ω–µ</span>
                                <small>–ë–µ–∑–ø–ª–∞—Ç–Ω–æ</small>
                            </button>
                            <button class="tool-btn" onclick="selectTool('info')" data-tool="info">
                                <i class="fas fa-info-circle"></i>
                                <span>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span>
                                <small>–ë–µ–∑–ø–ª–∞—Ç–Ω–æ</small>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- City Grid -->
            <div class="city-grid-container">
                <h3><i class="fas fa-th"></i> –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≥—Ä–∞–¥–∞</h3>
                <div class="selected-tool-info" id="selected-tool-info">
                    <span>–ò–∑–±—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: <strong id="current-tool">–ù—è–º–∞</strong></span>
                </div>
                <div class="city-grid" id="city-grid">
                    <!-- Grid cells will be generated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Eco Feed Section -->
    <section id="feed" class="section hidden">
        <div class="section-header">
            <h2><i class="fas fa-leaf"></i> –ï–∫–æ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <p>–°–ø–æ–¥–µ–ª–µ—Ç–µ –≤–∞—à–∏—Ç–µ –µ–∫–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∏ —Å –æ–±—â–Ω–æ—Å—Ç—Ç–∞</p>
            
            <!-- Charity Notice -->
            <div class="charity-notice">
                <div class="charity-content">
                    <i class="fas fa-heart"></i>
                    <div class="charity-text">
                        <h4>–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç</h4>
                        <p>–ó–∞ –≤—Å–µ–∫–∏ 500 —Å—ä–±—Ä–∞–Ω–∏ —Ç–æ—á–∫–∏ –æ—Ç –æ–±—â–Ω–æ—Å—Ç—Ç–∞ –¥–∞—Ä—è–≤ame 1 –ª–≤. –∑–∞ –∑–∞–ª–µ—Å—è–≤–∞–Ω–µ –∏ –æ–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–∞—Ç–∞!</p>
                        <div class="charity-progress">
                            <span id="charity-total-points">0</span>/500 —Ç–æ—á–∫–∏ –¥–æ —Å–ª–µ–¥–≤–∞—â–æ—Ç–æ –¥–∞—Ä–µ–Ω–∏–µ
                            <div class="progress-bar">
                                <div class="progress-fill" id="charity-progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="btn-primary" onclick="showAddActionModal()">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏ –¥–µ–π—Å—Ç–≤–∏–µ
            </button>
        </div>
        <div class="feed-container">
            <div class="eco-post">
                <div class="post-header">
                    <img src="https://via.placeholder.com/40" alt="user" class="user-avatar">
                    <div class="post-info">
                        <h4>–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞</h4>
                        <span class="post-date">–ø—Ä–µ–¥–∏ 2 —á–∞—Å–∞</span>
                    </div>
                    <div class="post-points">+10 —Ç–æ—á–∫–∏</div>
                </div>
                <div class="post-content">
                    <img src="https://via.placeholder.com/400x300" alt="eco action" class="post-image">
                    <h3>–ó–∞—Å–∞–¥–∏—Ö 3 –¥—ä—Ä–≤–µ—Ç–∞ –≤ –ë–æ—Ä–∏—Å–æ–≤–∞—Ç–∞ –≥—Ä–∞–¥–∏–Ω–∞</h3>
                    <p>–£—á–∞—Å—Ç–≤–∞—Ö –≤ –µ–∫–æ –∞–∫—Ü–∏—è –∑–∞ –∑–∞—Å–∞–∂–¥–∞–Ω–µ –Ω–∞ –¥—ä—Ä–≤–µ—Ç–∞. –í—Å–µ–∫–∏ –º–æ–∂–µ –¥–∞ –ø–æ–º–æ–≥–Ω–µ!</p>
                    <div class="post-location">
                        <i class="fas fa-map-marker-alt"></i> –ë–æ—Ä–∏—Å–æ–≤–∞ –≥—Ä–∞–¥–∏–Ω–∞, –°–æ—Ñ–∏—è
                    </div>
                </div>
                <div class="post-actions">
                    <button class="btn-like"><i class="fas fa-heart"></i> 15</button>
                    <button class="btn-comment"><i class="fas fa-comment"></i> 3</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Leaderboard Section -->
    <section id="leaderboard" class="section hidden">
        <div class="section-header">
            <h2><i class="fas fa-trophy"></i> –ö–ª–∞—Å–∞—Ü–∏—è</h2>
            <p>–¢–æ–ø –µ–∫–æ –≥–µ—Ä–æ–∏ –Ω–∞ –°–æ—Ñ–∏—è</p>
        </div>
        
        <!-- Statistics Overview -->
        <div class="leaderboard-stats">
            <div class="stat-card total-users">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-info">
                    <span class="stat-number" id="total-users">127</span>
                    <span class="stat-label">–ê–∫—Ç–∏–≤–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</span>
                </div>
            </div>
            <div class="stat-card total-actions">
                <div class="stat-icon"><i class="fas fa-leaf"></i></div>
                <div class="stat-info">
                    <span class="stat-number" id="total-actions">2,543</span>
                    <span class="stat-label">–û–±—â–æ –¥–µ–π—Å—Ç–≤–∏—è</span>
                </div>
            </div>
            <div class="stat-card total-points">
                <div class="stat-icon"><i class="fas fa-star"></i></div>
                <div class="stat-info">
                    <span class="stat-number" id="total-points">18,720</span>
                    <span class="stat-label">–û–±—â–æ —Ç–æ—á–∫–∏</span>
                </div>
            </div>
        </div>

        <!-- Leaderboard Filters -->
        <div class="leaderboard-filters">
            <button class="filter-btn active" onclick="filterLeaderboard('all')">–í—Å–∏—á–∫–∏</button>
            <div class="filter-dropdown">
                <button class="filter-btn dropdown-toggle" onclick="toggleTimeFilter()">
                    <span id="current-filter">–¢–æ–∑–∏ –º–µ—Å–µ—Ü</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-menu hidden" id="time-filter-menu">
                    <button onclick="filterLeaderboard('week')">–¢–∞–∑–∏ —Å–µ–¥–º–∏—Ü–∞</button>
                    <button onclick="filterLeaderboard('month')">–¢–æ–∑–∏ –º–µ—Å–µ—Ü</button>
                    <button onclick="filterLeaderboard('year')">–¢–∞–∑–∏ –≥–æ–¥–∏–Ω–∞</button>
                    <button onclick="filterLeaderboard('all')">–í—Å–∏—á–∫–∏ –≤—Ä–µ–º–µ–Ω–∞</button>
                </div>
            </div>
            <button class="filter-btn" onclick="filterLeaderboard('trees')">–î—ä—Ä–≤–µ—Ç–∞</button>
            <button class="filter-btn" onclick="filterLeaderboard('cleanup')">–ü–æ—á–∏—Å—Ç–≤–∞–Ω–µ</button>
            <button class="filter-btn" onclick="filterLeaderboard('bike')">–í–µ–ª–æ—Å–∏–ø–µ–¥</button>
        </div>

        <!-- Leaderboard Table -->
        <div class="leaderboard-container">
            <div class="leaderboard-table">
                <div class="table-header">
                    <div class="rank-header">–ü–æ–∑–∏—Ü–∏—è</div>
                    <div class="user-header">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</div>
                    <div class="points-header">–¢–æ—á–∫–∏</div>
                    <div class="actions-header">–î–µ–π—Å—Ç–≤–∏—è</div>
                    <div class="badges-header">–ë–∞–¥–∂–æ–≤–µ</div>
                </div>
                
                <!-- Top 3 Special Podium -->
                <div class="podium-section">
                    <div class="podium-item gold" id="user-1">
                        <div class="podium-rank">
                            <i class="fas fa-crown"></i>
                            <span>1</span>
                        </div>
                        <div class="podium-avatar">
                            <img src="https://via.placeholder.com/80" alt="user">
                            <div class="online-indicator"></div>
                        </div>
                        <div class="podium-info">
                            <h4>–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞</h4>
                            <div class="podium-stats">
                                <span class="points">1,250 —Ç–æ—á–∫–∏</span>
                                <span class="actions">85 –¥–µ–π—Å—Ç–≤–∏—è</span>
                            </div>
                            <div class="podium-badges">
                                <span class="badge eco-hero">–ï–∫–æ –≥–µ—Ä–æ–π</span>
                                <span class="badge tree-master">–ú–∞–π—Å—Ç–æ—Ä –¥—ä—Ä–≤–µ—Ç–∞</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="podium-item silver" id="user-2">
                        <div class="podium-rank">
                            <i class="fas fa-medal"></i>
                            <span>2</span>
                        </div>
                        <div class="podium-avatar">
                            <img src="https://via.placeholder.com/80" alt="user">
                        </div>
                        <div class="podium-info">
                            <h4>–ü–µ—Ç—ä—Ä –ò–≤–∞–Ω–æ–≤</h4>
                            <div class="podium-stats">
                                <span class="points">1,120 —Ç–æ—á–∫–∏</span>
                                <span class="actions">72 –¥–µ–π—Å—Ç–≤–∏—è</span>
                            </div>
                            <div class="podium-badges">
                                <span class="badge bike-rider">–í–µ–ª–æ—Å–∏–ø–µ–¥–∏—Å—Ç</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="podium-item bronze" id="user-3">
                        <div class="podium-rank">
                            <i class="fas fa-award"></i>
                            <span>3</span>
                        </div>
                        <div class="podium-avatar">
                            <img src="https://via.placeholder.com/80" alt="user">
                        </div>
                        <div class="podium-info">
                            <h4>–ê–Ω–Ω–∞ –ì–µ–æ—Ä–≥–∏–µ–≤–∞</h4>
                            <div class="podium-stats">
                                <span class="points">950 —Ç–æ—á–∫–∏</span>
                                <span class="actions">63 –¥–µ–π—Å—Ç–≤–∏—è</span>
                            </div>
                            <div class="podium-badges">
                                <span class="badge cleaner">–ü–æ—á–∏—Å—Ç–∏—Ç–µ–ª</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rest of leaderboard -->
                <div class="regular-rankings" id="leaderboard-list">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Your Position Card -->
            <div class="your-position">
                <h3><i class="fas fa-user"></i> –¢–≤–æ—è—Ç–∞ –ø–æ–∑–∏—Ü–∏—è</h3>
                <div class="position-card">
                    <div class="position-rank">#12</div>
                    <div class="position-avatar">
                        <img src="https://via.placeholder.com/60" alt="you">
                    </div>
                    <div class="position-info">
                        <h4>–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</h4>
                        <div class="position-stats">
                            <span class="points">420 —Ç–æ—á–∫–∏</span>
                            <span class="actions">28 –¥–µ–π—Å—Ç–≤–∏—è</span>
                        </div>
                        <div class="position-progress">
                            <span>–î–æ —Å–ª–µ–¥–≤–∞—â–∞ –ø–æ–∑–∏—Ü–∏—è: 45 —Ç–æ—á–∫–∏</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Air Quality Section -->
    <section id="air-quality" class="section hidden">
        <div class="section-header">
            <h2><i class="fas fa-wind"></i> –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤—ä–∑–¥—É—Ö–∞</h2>
            <p>–î–∞–Ω–Ω–∏ –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ –∑–∞ –≤—ä–∑–¥—É—à–Ω–æ—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ –≤ –°–æ—Ñ–∏—è</p>
        </div>
        
        <div class="air-quality-container">
            <!-- Current Air Quality Card -->
            <div class="air-quality-card main-card">
                <div class="card-header">
                    <h3><i class="fas fa-map-marker-alt"></i> –°–æ—Ñ–∏—è –¶–µ–Ω—Ç—ä—Ä</h3>
                    <div class="last-updated" id="last-updated">–ü–æ—Å–ª–µ–¥–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ: –∑–∞—Ä–µ–∂–¥–∞–Ω–µ...</div>
                </div>
                
                <div class="aqi-display">
                    <div class="aqi-value" id="aqi-value">--</div>
                    <div class="aqi-label">AQI</div>
                    <div class="aqi-status" id="aqi-status">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</div>
                </div>
                
                <div class="pollutants-grid">
                    <div class="pollutant-item">
                        <div class="pollutant-icon"><i class="fas fa-smog"></i></div>
                        <div class="pollutant-info">
                            <span class="pollutant-value" id="pm25-value">--</span>
                            <span class="pollutant-label">PM2.5</span>
                        </div>
                    </div>
                    <div class="pollutant-item">
                        <div class="pollutant-icon"><i class="fas fa-cloud"></i></div>
                        <div class="pollutant-info">
                            <span class="pollutant-value" id="pm10-value">--</span>
                            <span class="pollutant-label">PM10</span>
                        </div>
                    </div>
                    <div class="pollutant-item">
                        <div class="pollutant-icon"><i class="fas fa-flask"></i></div>
                        <div class="pollutant-info">
                            <span class="pollutant-value" id="no2-value">--</span>
                            <span class="pollutant-label">NO‚ÇÇ</span>
                        </div>
                    </div>
                    <div class="pollutant-item">
                        <div class="pollutant-icon"><i class="fas fa-industry"></i></div>
                        <div class="pollutant-info">
                            <span class="pollutant-value" id="o3-value">--</span>
                            <span class="pollutant-label">O‚ÇÉ</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Weather Information -->
            <div class="weather-card">
                <h3><i class="fas fa-cloud-sun"></i> –ú–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–Ω–∏ —É—Å–ª–æ–≤–∏—è</h3>
                <div class="weather-info">
                    <div class="weather-item">
                        <i class="fas fa-thermometer-half"></i>
                        <span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: <span id="temperature">--¬∞C</span></span>
                    </div>
                    <div class="weather-item">
                        <i class="fas fa-tint"></i>
                        <span>–í–ª–∞–∂–Ω–æ—Å—Ç: <span id="humidity">--%</span></span>
                    </div>
                    <div class="weather-item">
                        <i class="fas fa-wind"></i>
                        <span>–í—è—Ç—ä—Ä: <span id="wind-speed">-- –∫–º/—á</span></span>
                    </div>
                    <div class="weather-item">
                        <i class="fas fa-eye"></i>
                        <span>–í–∏–¥–∏–º–æ—Å—Ç: <span id="visibility">-- –∫–º</span></span>
                    </div>
                </div>
            </div>
            
            <!-- Health Recommendations -->
            <div class="health-recommendations">
                <h3><i class="fas fa-heart"></i> –ü—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –∑–¥—Ä–∞–≤–µ—Ç–æ</h3>
                <div class="recommendation-content" id="health-recommendations">
                    <p>–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏...</p>
                </div>
            </div>
            
            <!-- Historical Data Chart -->
            <div class="chart-container">
                <h3><i class="fas fa-chart-line"></i> 24-—á–∞—Å–æ–≤–∞ —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è</h3>
                <div class="chart-placeholder" id="air-quality-chart">
                    <p>–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞...</p>
                </div>
            </div>
            
            <!-- Location Selector -->
            <div class="location-selector">
                <h3><i class="fas fa-location-arrow"></i> –ò–∑–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—è</h3>
                <select id="location-select" onchange="changeLocation()">
                    <option value="sofia-center">–°–æ—Ñ–∏—è –¶–µ–Ω—Ç—ä—Ä</option>
                    <option value="sofia-lozenets">–°–æ—Ñ–∏—è –õ–æ–∑–µ–Ω–µ—Ü</option>
                    <option value="sofia-studentski-grad">–°–æ—Ñ–∏—è –°—Ç—É–¥–µ–Ω—Ç—Å–∫–∏ –≥—Ä–∞–¥</option>
                    <option value="sofia-druzhba">–°–æ—Ñ–∏—è –î—Ä—É–∂–±–∞</option>
                    <option value="sofia-lyulin">–°–æ—Ñ–∏—è –õ—é–ª–∏–Ω</option>
                </select>
                <button class="btn-secondary" onclick="getCurrentLocationAir()">
                    <i class="fas fa-crosshairs"></i> –ú–æ—è—Ç–∞ –ª–æ–∫–∞—Ü–∏—è
                </button>
            </div>
        </div>
    </section>

    <!-- Profile Section -->
    <section id="profile" class="section hidden">
        <div class="section-header">
            <h2><i class="fas fa-user"></i> –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –ø—Ä–æ—Ñ–∏–ª</h2>
        </div>
        <div class="profile-container">
            <div class="profile-card">
                <img src="https://via.placeholder.com/100" alt="profile" class="profile-avatar">
                <h3>–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</h3>
                <div class="profile-stats">
                    <div class="profile-stat">
                        <span class="stat-number">250</span>
                        <span class="stat-label">–¢–æ—á–∫–∏</span>
                    </div>
                    <div class="profile-stat">
                        <span class="stat-number">12</span>
                        <span class="stat-label">–î–µ–π—Å—Ç–≤–∏—è</span>
                    </div>
                    <div class="profile-stat">
                        <span class="stat-number">5</span>
                        <span class="stat-label">–ë–∞–¥–∂–æ–≤–µ</span>
                    </div>
                </div>
                <div class="user-badges">
                    <span class="badge"><i class="fas fa-seedling"></i> Tree Planter</span>
                    <span class="badge"><i class="fas fa-recycle"></i> Eco Hero</span>
                    <span class="badge"><i class="fas fa-bicycle"></i> Bike Rider</span>
                </div>
            </div>
            <div class="profile-history">
                <h4>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞</h4>
                <div class="history-item">
                    <div class="history-icon"><i class="fas fa-tree"></i></div>
                    <div class="history-content">
                        <h5>–ó–∞—Å–∞–¥–∏—Ö –¥—ä—Ä–≤–æ</h5>
                        <p>–ü–∞—Ä–∫ "–í–∏—Ç–æ—à–∞" - –ø—Ä–µ–¥–∏ 3 –¥–Ω–∏</p>
                    </div>
                    <div class="history-points">+15 —Ç–æ—á–∫–∏</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modals -->
    <div id="addLocationModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addLocationModal')">&times;</span>
            <h3>–î–æ–±–∞–≤–∏ –Ω–æ–≤–∞ –ª–æ–∫–∞—Ü–∏—è</h3>
            <form id="locationForm">
                <input type="text" placeholder="–ò–º–µ –Ω–∞ –ª–æ–∫–∞—Ü–∏—è—Ç–∞" required>
                <textarea placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" required></textarea>
                <select required>
                    <option value="">–ò–∑–±–µ—Ä–∏ —Ç–∏–ø</option>
                    <option value="park">–ü–∞—Ä–∫</option>
                    <option value="trail">–ï–∫–æ –ø—ä—Ç–µ–∫–∞</option>
                    <option value="bike">–í–µ–ª–æ–∞–ª–µ—è</option>
                    <option value="plant">–ú—è—Å—Ç–æ –∑–∞ –∑–∞—Å–∞–∂–¥–∞–Ω–µ</option>
                </select>
                <div class="form-group">
                    <label>–ö–ª–∏–∫–Ω–∏ –Ω–∞ –∫–∞—Ä—Ç–∞—Ç–∞ –∑–∞ –∏–∑–±–æ—Ä –Ω–∞ –ª–æ–∫–∞—Ü–∏—è:</label>
                    <div id="mini-map" class="mini-map">
                        <p>–ú–∏–Ω–∏ –∫–∞—Ä—Ç–∞ –∑–∞ –∏–∑–±–æ—Ä –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏</p>
                    </div>
                </div>
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏ –ª–æ–∫–∞—Ü–∏—è</button>
            </form>
        </div>
    </div>

    <div id="addActionModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addActionModal')">&times;</span>
            <h3>–î–æ–±–∞–≤–∏ –µ–∫–æ –¥–µ–π—Å—Ç–≤–∏–µ</h3>
            <form id="actionForm">
                <input type="text" name="title" placeholder="–ó–∞–≥–ª–∞–≤–∏–µ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ—Ç–æ" required>
                <textarea name="description" placeholder="–û–ø–∏—à–∏ –∫–∞–∫–≤–æ —Å–∏ –Ω–∞–ø—Ä–∞–≤–∏–ª..." required></textarea>
                <input type="file" name="image" accept="image/*">
                <select name="type" required>
                    <option value="">–¢–∏–ø –¥–µ–π—Å—Ç–≤–∏–µ</option>
                    <option value="tree">–ó–∞—Å–∞–∂–¥–∞–Ω–µ –Ω–∞ –¥—ä—Ä–≤–æ</option>
                    <option value="clean">–ü–æ—á–∏—Å—Ç–≤–∞–Ω–µ</option>
                    <option value="bike">–ö–∞—Ä–∞–Ω–µ –Ω–∞ –∫–æ–ª–µ–ª–æ</option>
                    <option value="recycle">–†–µ—Ü–∏–∫–ª–∏—Ä–∞–Ω–µ</option>
                </select>
                <input type="text" name="location" placeholder="–õ–æ–∫–∞—Ü–∏—è" required>
                <button type="submit" class="btn-primary">–°–ø–æ–¥–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ—Ç–æ</button>
            </form>
        </div>
    </div>

    <!-- Floating Chat Button -->
    <button id="chat-button">üå±</button>

    <!-- Chat Pop-up Modal -->
    <div id="chat-modal">
        <div id="chat-header">–ï–∫–æ –ê—Å–∏—Å—Ç–µ–Ω—Ç</div>
        <div id="chat-body">
            <!-- Messages will appear here -->
        </div>
        <div id="chat-footer">
            <input type="text" id="chat-input" placeholder="–ü–æ–ø–∏—Ç–∞–π –∑–∞ –µ–∫–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∏...">
            <button id="chat-send">–ò–∑–ø—Ä–∞—Ç–∏</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatButton = document.getElementById('chat-button');
            const chatModal = document.getElementById('chat-modal');
            const chatInput = document.getElementById('chat-input');
            const chatSend = document.getElementById('chat-send');
            const chatBody = document.getElementById('chat-body');

            // Toggle chat modal
            chatButton.addEventListener('click', () => {
                chatModal.style.display = chatModal.style.display === 'none' ? 'block' : 'none';
            });

            // Send message on button click or Enter key
            chatSend.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });

            function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;

                // Add user message to chat body
                addMessage('user-message', message);
                chatInput.value = '';

                // Send to backend
                fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.reply) {
                        addMessage('ai-message', data.reply);
                    } else {
                        addMessage('ai-message', '–ì—Ä–µ—à–∫–∞: ' + data.error);
                    }
                })
                .catch(error => {
                    addMessage('ai-message', '–ì—Ä–µ—à–∫–∞: ' + error.message);
                });
            }

            function addMessage(className, text) {
                const div = document.createElement('div');
                div.classList.add('message', className);
                div.textContent = text;
                chatBody.appendChild(div);
                chatBody.scrollTop = chatBody.scrollHeight; // Scroll to bottom
            }
        });
    </script>

    <script src="script.js"></script>
</body>
</html>